RewriteEngine On
RewriteBase /

# Permitir acesso a ficheiros estáticos
RewriteCond %{REQUEST_FILENAME} -f

RewriteEngine On
RewriteBase /api/

# Permitir acesso a ficheiros estáticos
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Redirecionar raiz /api/ para public/index.html
RewriteRule ^$ public/index.html [L]
RewriteRule ^index.html$ public/index.html [L]

# Bloquear listagem de diretórios
Options -Indexes

# Bloquear acesso direto à pasta data e ficheiros sensíveis
RewriteRule ^data/ - [F]
<FilesMatch "\.(json|log)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# API Routes
RewriteRule ^request-key/?$ api/request-key.php [L]
RewriteRule ^calculate/?$ api/calculate.php [L]
RewriteRule ^info/?$ api/info.php [L]
RewriteRule ^admin-login/?$ api/admin-login.php [L]
RewriteRule ^admin-keys/?$ api/admin-keys.php [QSA,L]
RewriteRule ^admin-keys/([^/]+)/block/?$ api/admin-keys.php?key=$1&action=block [QSA,L]
RewriteRule ^admin-keys/([^/]+)/?$ api/admin-keys.php?key=$1 [QSA,L]

# Admin interface
RewriteRule ^admin.html$ public/admin.html [L]
RewriteRule ^admin/admin.html$ admin/admin.html [L]
