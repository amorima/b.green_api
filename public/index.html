<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>b.green API - Cálculo de Emissões de Carbono</title>
<style>
:root{--green-primary:#8cb161;--green-secondary:#426934;--green-dark:#234736;--green-light:#e5eda0;--text-dark:#1c1917;--text-medium:#253f1d;--border:#e7e5e4;--bg:#ffffff;--input-bg:#f5f5f4}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text-dark);line-height:1.6}.container{max-width:1100px;margin:0 auto;padding:2rem}header{background:linear-gradient(135deg,var(--green-secondary),var(--green-primary));color:white;padding:3rem 2rem;border-radius:12px;margin-bottom:3rem;box-shadow:0 4px 6px rgba(0,0,0,0.1)}h1{font-size:2.5rem;margin-bottom:0.5rem}h2{color:var(--green-dark);margin:2rem 0 1rem;font-size:1.8rem}.section{background:white;padding:2rem;border-radius:8px;border:1px solid var(--border);margin-bottom:2rem;box-shadow:0 2px 4px rgba(0,0,0,0.05)}input,select{width:100%;padding:0.8rem;margin:0.5rem 0;border:1px solid var(--border);border-radius:6px;background:var(--input-bg);font-size:1rem}input:focus,select:focus{outline:none;border-color:var(--green-primary);background:white}button{background:var(--green-primary);color:white;padding:0.8rem 2rem;border:none;border-radius:6px;font-size:1rem;cursor:pointer;font-weight:600;transition:all 0.2s}button:hover{background:var(--green-secondary);transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.15)}.result{margin-top:1rem;padding:1rem;background:var(--input-bg);border-left:4px solid var(--green-primary);border-radius:4px}.code{background:var(--green-dark);color:var(--green-light);padding:1rem;border-radius:6px;overflow-x:auto;font-family:monospace;font-size:0.9rem}.hidden{display:none}.form-group{margin-bottom:1rem}label{display:block;margin-bottom:0.5rem;color:var(--text-medium);font-weight:600}
</style>
</head>
<body>
<div class="container">
<header><h1> b.green API</h1><p>API para cálculo de emissões de carbono</p></header>
<div class="section"><h2> Obter API Key</h2><div class="form-group"><label>Email:</label><input type="email" id="email" placeholder="seu@email.com"></div><button onclick="requestKey()">Obter API Key</button><div id="keyResult" class="result hidden"></div></div>
<div class="section"><h2> Testar API</h2><div class="form-group"><label>API Key:</label><input type="text" id="apiKey" placeholder="bgk_..."></div><div class="form-group"><label>Tipo de Atividade:</label><select id="type" onchange="updateForm()"><optgroup label="Por Quantidade"><option value="energy_electric">Eletricidade (kWh)</option><option value="energy_gas">Gás Natural (m)</option><option value="transport_car_gasoline">Carro Gasolina (km)</option><option value="transport_car_diesel">Carro Diesel (km)</option></optgroup><optgroup label="Por Tempo de Uso"><option value="device_laptop">Portátil (minutos)</option><option value="device_desktop">Desktop (minutos)</option><option value="device_tv">Televisão (minutos)</option></optgroup></select></div><div class="form-group" id="amountGroup"><label>Quantidade:</label><input type="number" id="amount" step="0.01" placeholder="0"></div><div class="form-group hidden" id="minutesGroup"><label>Minutos de Uso:</label><input type="number" id="minutes" step="1" placeholder="0"></div><button onclick="testCalculate()">Calcular Emissões</button><div id="calcResult" class="result hidden"></div></div>
<div class="section"><h2> Documentação</h2><p><strong>Endpoint:</strong> <code>https://www.antonioamorim.pt/api/calculate</code></p><p><strong>Método:</strong> POST</p><p><strong>Headers obrigatórios:</strong></p><div class="code">X-API-Key: bgk_sua_key_aqui<br>Content-Type: application/json</div><p style="margin-top:1rem"><strong>Limite:</strong> 100 pedidos por 15 minutos</p></div>
</div>
<script>
async function requestKey(){const email=document.getElementById('email').value;if(!email.includes('@'))return alert('Email inválido');try{const r=await fetch('/api/request-key',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email})});const d=await r.json();if(d.success){document.getElementById('keyResult').innerHTML=`<strong>API Key:</strong> ${d.data.key}<br><strong>Email:</strong> ${d.data.email}<br><strong>Pedidos:</strong> ${d.data.requests||0}`;document.getElementById('keyResult').classList.remove('hidden');document.getElementById('apiKey').value=d.data.key}else alert(d.error)}catch(e){alert('Erro: '+e.message)}}
async function testCalculate(){const key=document.getElementById('apiKey').value;const type=document.getElementById('type').value;const isDevice=type.startsWith('device_');let body={type};if(isDevice){body.minutes=parseInt(document.getElementById('minutes').value)}else{body.amount=parseFloat(document.getElementById('amount').value)}try{const r=await fetch('/api/calculate',{method:'POST',headers:{'Content-Type':'application/json','X-API-Key':key},body:JSON.stringify(body)});const d=await r.json();if(d.success){document.getElementById('calcResult').innerHTML=`<strong>Emissões CO2:</strong> ${d.data.carbon_kg_co2} kg<br><strong>Tipo:</strong> ${d.data.type}`;document.getElementById('calcResult').classList.remove('hidden')}else alert(d.error)}catch(e){alert('Erro: '+e.message)}}
function updateForm(){const type=document.getElementById('type').value;const isDevice=type.startsWith('device_');document.getElementById('amountGroup').classList.toggle('hidden',isDevice);document.getElementById('minutesGroup').classList.toggle('hidden',!isDevice)}
</script>
</body>
</html>
